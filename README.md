# 不想排座位

一个用于班级排座与布局管理的 Web 系统，覆盖从班级创建、名单导入、布局设计到自动排座与导出的完整流程，适合日常班级管理与考试临时排座场景。

## 功能总览
- 多班级管理：创建、切换、复制班级配置
- 可视化布局：座位/走廊/讲台/空位等元素的可视化编辑
- 拖拽排座：支持暂存区与快捷键操作
- 名单导入导出：Excel 导入学生名单、导出排座表
- 自动排座：随机、按成绩、相邻差异、前后排等策略
- 小组系统：小组分配、登记表导出
- 约束规则：行/列/座位限制、相邻/禁止相邻约束
- 布局快照：保存布局状态并一键回滚
- 自有格式：`.seats` 文件导入导出

## 技术栈
- 后端：Django
- 数据库：SQLite（默认本地文件）
- 生产服务：Waitress
- 静态服务：Whitenoise
- Excel 处理：pandas + openpyxl

## 目录结构
- `manage.py`：Django 管理入口
- `run_app.py`：一键启动（Waitress + 自动迁移）
- `db.sqlite3`：默认数据库文件
- `config/`：Django 配置与 WSGI
- `seats/`：业务模块（班级、布局、排座）
- `templates/`：页面模板
- `static/`、`staticfiles/`：静态资源

## 安装与运行

1. 安装依赖：
   ```bash
   pip3 install -r requirements.txt
   ```

2. 初始化数据库（首次运行建议执行）：
   ```bash
   python3 manage.py migrate
   ```

3. 启动服务（推荐）：
   ```bash
   python3 run_app.py
   ```
   默认访问地址：`http://127.0.0.1:23948`

### 开发模式
用于本地调试时，直接启动 Django 开发服务器：
```bash
python3 manage.py runserver
```
默认地址：`http://127.0.0.1:8000`

## 使用指南

### 1. 新建班级
1. 进入系统首页，创建班级。
2. 进入班级详情页，开始导入名单或编辑布局。

### 2. 名单导入
支持 Excel 批量导入学生信息。
1. 进入班级详情页，点击工具栏“导入名单”。
2. 上传 `.xlsx` 或 `.xls` 文件。
3. 文件必须包含表头 `姓名`。
   - 可选列：`学号`、`性别`（男/女）、`成绩`。
4. 勾选“清空现有名单”可覆盖当前班级所有学生。

### 3. 布局编辑
1. 使用布局编辑工具创建座位、走廊、讲台、空位等元素。
2. 拖拽学生到座位或暂存区完成排座。
3. 需要时可使用快捷键提高效率。

### 4. 自动排座
1. 在排座工具中选择策略（随机/按成绩/相邻差异/前后排）。
2. 可结合约束规则进行约束排座。
3. 排座结果可随时手动微调。

### 5. 小组功能
1. 在小组页面设置小组数量与成员。
2. 支持导出小组登记表，便于打印或分享。

### 6. 快照系统
用于保存某一时刻的完整布局状态。
- 保存快照：在调整好座位后点击“保存快照”并命名。
- 恢复快照：点击已保存的快照即可回到当时状态。
- 适用场景：考试排座、日常排座、多方案对比。

### 7. 导入导出
- Excel 导出：导出学生排座表。
- `.seats` 导入导出：用于完整布局与约束的保存与恢复。

## 快捷键
- 撤销：Ctrl+Z
- 重做：Ctrl+Y
- 复制：Ctrl+C
- 剪切：Ctrl+X
- 粘贴：Ctrl+V
- 删除：Delete
- 移动到暂存区：Ctrl+D
- 从暂存区取出：Ctrl+U

## 注意事项
- Excel 导入必须包含“姓名”列，可选“学号”、“性别”、“成绩”列。
- `.seats` 导入会覆盖当前班级的学生、布局、小组与约束。
- `db.sqlite3` 为默认数据库文件，备份时请直接复制该文件。

## 开发者
- 名称：老三
- 网站：www.577622.xyz
